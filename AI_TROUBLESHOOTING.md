# 🔧 Troubleshooting - Dlaczego nie widzę AI insights?

## Problem: Sekcje AI nie pojawiają się w wynikach audytu

### ✅ Szybkie rozwiązania

#### 1. **Sprawdź czy AI jest włączone**

**Plik:** `config.py` (linia 13)
```python
ENABLE_AI_ANALYSIS = True  # Musi być True!
```

Jeśli jest `False` → zmień na `True` i zrestartuj backend.

---

#### 2. **Sprawdź czy klucz Gemini jest wpisany**

**Plik:** `config_local.py`
```python
GEMINI_API_KEY = "AIzaSy..."  # Musi być prawdziwy klucz, nie placeholder!
```

**Jak sprawdzić:**
```bash
python ai_engine.py
```

**Powinno być:**
```
✅ Gemini AI Engine initialized successfully
✅ AI Engine is ready!
```

**Jeśli błąd:**
- Klucz nieprawidłowy → Wygeneruj nowy na https://aistudio.google.com/apikey
- Brak internetu → Sprawdź połączenie
- Quota exceeded → Przekroczono limit 1,500 zapytań/dzień

---

#### 3. **Sprawdź logi backendu (terminal)**

Po uruchomieniu `python app.py`, podczas audytu powinno być widoczne:

```
Starting audit for: https://example.com
  - Technical analysis...
  - On-page analysis...
  - Indexing analysis...
  - Content analysis...
  - PageSpeed analysis...
  - AI Content Quality analysis (Gemini 2.5 Flash)...    <-- TO MUSI BYĆ!
    AI Content Score: 75/100
  - Generating AI Action Plan...                         <-- TO TEŻ!
    ✓ Generated action plan with 5 AI quick wins
Audit complete!
```

**Jeśli NIE ma powyższych linii AI:**
- Sprawdź kroki 1 i 2
- Zobacz błędy w terminalu (czerwony tekst)
- Sprawdź czy `google-genai` jest zainstalowany: `pip list | grep google-genai`

---

#### 4. **Gdzie dokładnie pojawiają się sekcje AI?**

**Lokalizacja w UI:**

```
┌─────────────────────────────────────┐
│ Wyniki Audytu SEO                   │  <- Główny wynik (score)
├─────────────────────────────────────┤
│ Kategorie (Technical, On-Page...)   │  <- Zwykłe kategorie
├─────────────────────────────────────┤
│ Quick Wins                           │  <- Szybkie akcje
├─────────────────────────────────────┤
│ 🤖 AI-Powered Action Plan           │  <- SEKCJA AI #1 (fioletowe tło)
│   - Overall Strategy                 │
│   - AI Quick Wins                    │
│   - 30/60/90 Day Roadmap            │
│   - Score Progression                │
└─────────────────────────────────────┘
│ 🎯 AI Content Insights              │  <- SEKCJA AI #2 (zielone tło)
│   - Search Intent Analysis           │
│   - E-E-A-T Signals (4 wskaźniki)   │
│   - Content Depth Analysis           │
└─────────────────────────────────────┘
```

**Charakterystyka:**
- **Fioletowe/purpurowe tło** (AI Action Plan)
- **Zielone tło** (AI Content Insights)
- Ikona 🤖 lub 🎯 w nagłówku
- Tekst "Generated by Gemini 2.5 Flash"

**Jeśli ich nie widzisz:**
- Przewiń stronę w dół (są pod Quick Wins!)
- Sprawdź konsolę przeglądarki (F12) → szukaj błędów JavaScript
- Odśwież stronę (Ctrl+F5 / Cmd+Shift+R)

---

## 🔍 Diagnostyka krok po kroku

### Test 1: Sprawdź backend
```bash
cd x:\Aplikacje\seo-aiditor
python app.py
```

Czekaj na: `Running on http://127.0.0.1:5000`

### Test 2: Sprawdź AI Engine
```bash
python ai_engine.py
```

**Oczekiwany output:**
```
Testing AI Engine...
✅ Gemini AI Engine initialized successfully
✅ AI Engine is ready!

Test Result: {"sentiment": "positive", "summary": "brief summary"}
```

**Błędy i rozwiązania:**

| Błąd | Przyczyna | Rozwiązanie |
|------|-----------|-------------|
| `ModuleNotFoundError: No module named 'google.genai'` | Brak biblioteki | `pip install google-genai` |
| `API key not valid` | Nieprawidłowy klucz | Wygeneruj nowy klucz |
| `AI Engine not available` | Placeholder w config | Wpisz prawdziwy klucz w `config_local.py` |
| `403 Forbidden` | Restrykcje API key | Usuń restrykcje w Google Cloud Console |
| `Network error` | Brak internetu | Sprawdź połączenie |

### Test 3: Sprawdź config_local.py
```bash
# Windows
type config_local.py

# Mac/Linux
cat config_local.py
```

**Powinno zawierać:**
```python
GOOGLE_PSI_API_KEY = "AIza..."  # Prawdziwy klucz PageSpeed
GEMINI_API_KEY = "AIza..."      # Prawdziwy klucz Gemini (inny niż PSI!)
```

### Test 4: Uruchom pełny audyt z logami
```bash
python app.py
```

W drugiej konsoli/przeglądarce:
1. Otwórz `http://localhost:5000` lub `index.html`
2. Wpisz URL: `https://example.com`
3. Kliknij "Rozpocznij Audyt"
4. **Obserwuj pierwszy terminal** - szukaj linii z "AI"

---

## 🚨 Najczęstsze problemy

### Problem #1: "AI not available - check API key"

**Przyczyna:** Klucz Gemini nie jest wpisany lub nieprawidłowy

**Fix:**
1. Otwórz `config_local.py`
2. Sprawdź linię: `GEMINI_API_KEY = "..."`
3. Jeśli jest `"YOUR_GEMINI_API_KEY_HERE"` → wpisz prawdziwy klucz
4. Klucz musi zaczynać się od `AIza...`
5. Zrestartuj `python app.py`

---

### Problem #2: Sekcje AI są puste (brak danych)

**Przyczyna:** API zwróciło błąd ale gracefully degraded

**Fix:**
1. Sprawdź logi backendu - szukaj:
   ```
   Warning: AI Content analysis failed: <error>
   Warning: AI Action Plan failed: <error>
   ```
2. Najczęstsze błędy:
   - **"Invalid JSON"** → Problem z parsowaniem odpowiedzi AI (retry help)
   - **"Timeout"** → Strona zbyt duża lub wolny internet
   - **"Quota exceeded"** → Przekroczono limit 1,500/day

---

### Problem #3: Backend crashuje po dodaniu AI

**Przyczyna:** Konflikt wersji bibliotek lub błąd w kodzie

**Fix:**
1. Odinstaluj i zainstaluj na nowo:
   ```bash
   pip uninstall google-genai
   pip install google-genai>=0.3.0
   ```
2. Sprawdź wersję Pythona:
   ```bash
   python --version  # Musi być 3.8+
   ```
3. Zobacz pełny stack trace w terminalu

---

### Problem #4: "ModuleNotFoundError: No module named 'config_local'"

**Przyczyna:** Brak pliku `config_local.py`

**Fix:**
```bash
# Skopiuj przykładowy plik
copy config_local.example.py config_local.py   # Windows
cp config_local.example.py config_local.py     # Mac/Linux

# Edytuj i wstaw klucze
notepad config_local.py   # Windows
nano config_local.py      # Mac/Linux
```

---

### Problem #5: Działa lokalnie, ale nie widać AI w frontend

**Przyczyna:** Frontend nie otrzymuje danych AI z backendu

**Fix:**
1. Otwórz DevTools (F12) → Console
2. Szukaj błędów JavaScript (czerwone)
3. Sprawdź Network tab → znajdź request `/api/audit`
4. Zobacz response → czy zawiera klucze `ai_content` i `ai_action_plan`?

**Jeśli NIE:**
- Backend nie zwraca AI danych → zobacz logi backendu
- CORS error → sprawdź `flask-cors` instalację

**Jeśli TAK (są w response):**
- Problem z renderowaniem UI
- Sprawdź czy sekcje nie są ukryte przez CSS
- Ctrl+F5 (force refresh)

---

## 📝 Checklist debugowania

Wykonaj krok po kroku:

- [ ] `ENABLE_AI_ANALYSIS = True` w `config.py`
- [ ] `config_local.py` istnieje i ma klucz Gemini
- [ ] `python ai_engine.py` → "✅ AI Engine is ready!"
- [ ] `pip list | grep google-genai` → zainstalowane
- [ ] Backend wyświetla linie "AI Content Quality analysis..."
- [ ] Browser Console (F12) → brak błędów JavaScript
- [ ] Network tab → `/api/audit` response zawiera `ai_content` i `ai_action_plan`
- [ ] Przewinąłem stronę w dół (pod Quick Wins)
- [ ] Odświeżyłem przeglądarkę (Ctrl+F5)

Jeśli wszystko ✅ a dalej nie działa → otwórz GitHub Issue z logami!

---

## 🆘 Dalej nie działa?

**Zbierz informacje:**

1. **Wersja Pythona:** `python --version`
2. **Zainstalowane biblioteki:** `pip list`
3. **Logi backendu:** Skopiuj OUTPUT z `python app.py`
4. **Console błędy:** F12 → Console → screenshot
5. **Network response:** F12 → Network → `/api/audit` → Response → screenshot

**Otwórz issue:**
https://github.com/maciusman/seo-aiditor/issues

Podaj wszystkie zebrane informacje!

---

## 💡 Szybki test end-to-end

**Uruchom to w terminalu:**

```bash
# Test 1: AI Engine
python ai_engine.py

# Test 2: Backend
python app.py &

# Poczekaj 3 sekundy

# Test 3: Curl audit (z loggingiem)
curl -X POST http://localhost:5000/api/audit \
  -H "Content-Type: application/json" \
  -d '{"url":"https://example.com"}' \
  | python -m json.tool | grep -A 5 "ai_content"
```

**Powinno zwrócić:**
```json
"ai_content": {
  "score": 75,
  "insights": {
    "search_intent": {...},
    "eeat": {...}
  }
}
```

Jeśli dostaniesz powyższe → AI działa! Problem jest w frontend.

---

**Pytania? Zobacz:** [GEMINI_API_SETUP.md](GEMINI_API_SETUP.md) sekcja Troubleshooting
